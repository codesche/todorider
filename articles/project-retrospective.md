
# í”„ë¡œì íŠ¸ íšŒê³  (25. 06 ~ 25. 08)

## ë“¤ì–´ê°€ë©°

ìµœê·¼ ëª‡ ë‹¬ ë™ì•ˆ ì§„í–‰í•œ ì„¸ ê°€ì§€ í”„ë¡œì íŠ¸ë¥¼ íšŒê³  ì°¨ì›ì—ì„œ ì •ë¦¬í•´ë´¤ë‹¤.

- **MoodBook**: ê°ì • ê¸°ë°˜ ë„ì„œ ì¶”ì²œ í”Œë«í¼  
  - https://github.com/moodbook-space/moodbook-backend
- **DungeonTalk**: ì‹¤ì‹œê°„ TRPG ê²Œì„ í”Œë«í¼  
  - https://github.com/DungeonTalk/dungeontalk-backend
- **Auth í”„ë¡œì íŠ¸:** íšŒì›ê°€ì…/ë¡œê·¸ì¸ ì¸ì¦ ì‹œìŠ¤í…œ  
  - https://github.com/codesche/devcenter/tree/main/authproject

**ğŸ“ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ì ìš©í•œ ê·œì¹™**

- ì•„ë¬´ë¦¬ AIë¥¼ ì˜ í™œìš©í•œë‹¤ í• ì§€ë¼ë„ 100% í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±ì‹œí‚¤ê¸°ë€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.
- ì–´ëŠ ì •ë„ ë„ë©”ì¸ ì§€ì‹ê³¼ ê°œë°œ ê²½í—˜ì´ ê°–ì¶°ì§€ì§€ ì•Šìœ¼ë©´ ì½”ì–´ ê°œë°œìë¡œ ì„±ì¥í•˜ê¸° ì–´ë µë‹¤.
- AIë¥¼ í™œìš©í•˜ëŠ” íŒ€ì›ë“¤ì˜ ì„±í–¥ì„ ê³ ë ¤í•˜ì—¬ ëª‡ ê°€ì§€ ê·œì¹™ì„ ì„¸ì›Œì„œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.
- íšŒê³ ë¥¼ ìœ„í•´ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ì ìš©í•œ ê·œì¹™ê³¼ ê·¸ì— ëŒ€í•œ ì‚¬ë¡€ì™€ ì˜ˆì œë¥¼ ì •ë¦¬í•´ë´¤ë‹¤.

## ê·œì¹™ ìš”ì•½ í‘œ

| ë²ˆí˜¸ | ê·œì¹™ |
| --- | --- |
| 1 | ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬(@ControllerAdvice) + ì˜ë¯¸ ìˆëŠ” ë„ë©”ì¸ ì˜ˆì™¸ |
| 2 | ê³µí†µ API ì‘ë‹µê°ì²´ í•„ìš” |
| 3 | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì„œë¹„ìŠ¤ ê³„ì¸µì—ë§Œ ì‘ì„± (ì»¨íŠ¸ë¡¤ëŸ¬ ê³„ì¸µì—ëŠ” ì‘ì„±í•˜ì§€ ì•ŠìŒ) |
| 4 | DTO ê°ì²´ í™œìš©í•˜ì—¬ ë°ì´í„° ì „ë‹¬í•˜ê¸° |
| 5 | ìºì‹±ì„ ë„ì…í•˜ì—¬ ì„±ëŠ¥ ê°œì„ ì— ëŒ€í•œ ì¼€ì´ìŠ¤ ë§Œë“¤ ìˆ˜ ìˆì–´ì•¼ í•¨ |
| 6 | JWT í† í° í™œìš©í•˜ì—¬ ê¸°ë³¸ì ì¸ íšŒì›ê°€ì…/ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„ (RefreshTokenì€ Redisì— ì €ì¥) |
| 7 | ì¸ì¦ ê´€ë ¨ ë³´ì•ˆ ìˆ˜ì¤€ì„ ì–´ëŠ ì •ë„ ê³ ë ¤í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¡œ êµ¬í˜„ (ì‹œíì–´ ì½”ë”©) |
| 8 | ì „ë°˜ì ì¸ DB ì„¤ê³„ë‚˜ ê°œë°œ ë¡œì§ì€ ëŒ€ê·œëª¨ íŠ¸ë˜í”½ì„ ì¶©ë¶„íˆ ëŒ€ë¹„í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¡œ ê°œë°œ |
| 9 | ëª¨ë‹ˆí„°ë§ + ë¶€í•˜í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆëŠ” ë°©í–¥ìœ¼ë¡œ ê°œë°œ |
| 10 | LocalDateTimeì´ ì•„ë‹Œ Instant í´ë˜ìŠ¤ë¡œ ì ìš© (í™•ì¥ì„± ê³ ë ¤) |
| 11 | record ì“°ì§€ ì•Šê³  dtoë¡œ ì‘ì„± |
| 12 | @Setter ì–´ë…¸í…Œì´ì…˜ì€ ì§€ì–‘ |
| 13 | íš¨ìœ¨ì ì¸ ë””ìì¸ íŒ¨í„´ ì ìš© (ìƒì„±, êµ¬ì¡°, í–‰ìœ„ íŒ¨í„´) |
| 14 | JUnit 5 + Mockito ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ì‘ì„± |
| 15 | ê°€ê¸‰ì  kotlin ì½”ë“œëŠ” ì ˆëŒ€ ë‚˜íƒ€ë‚˜ì§€ ì•Šë„ë¡ |
| 16 | ì½”ë“œ ì‘ì„± ì‹œ íŒ¨í‚¤ì§€ ê²½ë¡œë¥¼ ìƒì„¸í•˜ê²Œ ë‚˜íƒ€ë‚´ê¸° |
| 17 | ìƒí™©ë§ˆë‹¤ ì ìš©í•˜ê¸° ì¢‹ì€ ì•Œê³ ë¦¬ì¦˜ ë°˜ì˜ |
| 18 | entity(dao)ëŠ” ì ˆëŒ€ë¡œ ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ì§€ ë§ ê²ƒ |
| 19 | JPA N+1 ë¬¸ì œ ë°œìƒí•˜ì§€ ì•Šì€ ì½”ë“œ ì‘ì„± |
| 20 | ì„±ëŠ¥ ìµœì í™”ë¥¼ ê³ ë ¤í•œ ì½”ë“œ ì‘ì„± |
| 21 | ë„ë©”ì¸ë³„ ì„œë¹„ìŠ¤ ë¶„ë¦¬ ì—†ì´ í•œ í´ë˜ìŠ¤ì— ëª°ì•„ë„£ì§€ ì•Šê¸° |
| 22 | ê¸°ë³¸ LAZY, ì¡°íšŒ ì „ìš©ì€ fetch join/EntityGraph/ì „ìš© ì¿¼ë¦¬ DTO í™œìš© |
| 23 | ì—”í‹°í‹°ë¥¼ ì‘ë‹µìœ¼ë¡œ ì§ë ¬í™” |
| 24 | Service ë©”ì„œë“œ ë‹¨ìœ„ @Transactional (ì¡°íšŒ ì „ìš©ì€ readOnly=true) ë¡œ ì‘ì„± |
| 25 | í”„ë¡œíŒŒì¼ë§ â†’ í•«ìŠ¤íŒŸ íŒŒì•… â†’ ìºì‹œ ì „ëµ(TTL/í‚¤/ë¬´íš¨í™”) ì„¤ê³„ í›„ ì ìš© |
| 26 | ìš”ì²­/ì‘ë‹µ/ë„ë©”ì¸ DTO ë¶„ë¦¬, ê²€ì¦ì€ ìš”ì²­ DTOì— @Valid |
| 27 | ì¡°ê±´ ê¸°ë°˜ í˜ì´ì§•/í•„í„° ì¿¼ë¦¬ ì„¤ê³„, ì¸ë±ìŠ¤ ì ê²€ |
| 28 | ë‹¨ìœ„(ì„œë¹„ìŠ¤) ìš°ì„  + ìŠ¬ë¼ì´ìŠ¤(@DataJpaTest, @WebMvcTest) ë³‘í–‰ |
| 29 | Testcontainers/Embedded í™œìš©, ì‹œí¬ë¦¿ì€ í…ŒìŠ¤íŠ¸ìš© ë³„ë„ |
| 30 | ë¬´ìƒíƒœ ì„œë²„, í™•ì¥ ê³ ë ¤í•œ ì½”ë“œ ì‘ì„± |
| 31 | ë¡œê·¸Â·ë©”íŠ¸ë¦­Â·íŠ¸ë ˆì´ìŠ¤ êµ¬ì„± |
| 32 | AccessëŠ” í´ë¼ì´ì–¸íŠ¸, RefreshëŠ” ì„œë²„ì¸¡ ì €ì¥(DB/Redis) + íšŒì „ |
| 33 | í™˜ê²½ ë³€ìˆ˜/Secret Manager ì‚¬ìš©, @ConfigurationPropertiesë¡œ ì£¼ì… |
| 34 | ì™¸ë¶€ I/OëŠ” íŠ¸ëœì­ì…˜ ë°–ì—ì„œ ìˆ˜í–‰í•˜ê±°ë‚˜ SAGA/Outbox íŒ¨í„´ |
| 35 | ë‚™ê´€ì  ë½ + ì¬ì‹œë„ë¥¼ ê¸°ë³¸, í•„ìš”í•œ ê³³ë§Œ ë¹„ê´€ì  ë½ |
| 36 | íŒ¨í‚¤ì§€ ì˜ì¡´ ë°©í–¥ì„ í•œìª½ìœ¼ë¡œ ê³ ì • (ë„ë©”ì¸â†’ì• í”Œë¦¬ì¼€ì´ì…˜â†’ì¸í”„ë¼) |
| 37 | í•„ìš”í•œ Origin/Methodë§Œ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ |
| 38 | ë§ˆìŠ¤í‚¹/í•„í„°ë§ ì ìš©, ìš”ì²­/ì‘ë‹µ ë°”ë”” ë¡œê¹…ì€ ìƒ˜í”Œë§ |
| 39 | var í˜•ì‹ì€ ì§€ì–‘ |
| 40 | ì½”ë“œë¥¼ ì‘ì„±í•¨ì— ìˆì–´ ì¶©ë¶„íˆ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì£¼ì„ ë°˜ì˜ |
| 41 | @Getter, @Builder ì–´ë…¸í…Œì´ì…˜ í™œìš©. Setter ì‚¬ìš©ì€ ì§€ì–‘ |
| 42 | Request/Response DTO ì½”ë”© ìŠ¤íƒ€ì¼ ì¼ê´€ ìœ ì§€ (from/toEntity êµ¬ë¶„) |
| 43 | DTOì—ë„ @Builder ì ìš©, entity â†’ dto ë³€í™˜ ì ê·¹ í™œìš© |
| 44 | Service ê³„ì¸µì€ ì¸í„°í˜ì´ìŠ¤ë¡œ ë§Œë“¤ì§€ ì•ŠìŒ |
| 45 | íŒ¨í‚¤ì§€ëª… ì „ì²´ë¥¼ ê·¸ëŒ€ë¡œ ë³€ìˆ˜/í´ë˜ìŠ¤ëª…ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ |
| 46 | yml, build.gradle í™•ì‹¤í•˜ê²Œ ì‘ì„± |
| 47 | entity ì‘ì„± ì‹œ ìƒí™©ì— ë”°ë¼ AccessLevel.PRIVATE/PROTECTED ë°˜ì˜ |
| 48 | JPA dirty-checking ì ê·¹ ë°˜ì˜ |
| 49 | ë¶€ëª¨-ìì‹ PK-FK ê´€ê³„ ì‚­ì œ ì—°ê³„ ì²˜ë¦¬ (ì—°ê´€ëœ ê°ì²´ ì‚­ì œ ë³´ì¥) |
| 50 | BaseTimeì„ ì ìš©í•´ ìƒì„±/ìˆ˜ì • ì‹œê°„ ê´€ë¦¬ |
| 51 | BaseTimeì´ë‚˜ ì—”í‹°í‹°ì— protected í‚¤ì›Œë“œ ì‚¬ìš© ì§€ì–‘ |
| 52 | ìë£Œí˜•ë³„ ë°œìƒ ê°€ëŠ¥í•œ ì˜ˆì™¸ ê³ ë ¤ |
| 53 | ê¸€ë¡œë²Œ ì˜ˆì™¸ ì²˜ë¦¬ì™€ ê³µí†µ API ì‘ë‹µ ê°ì²´ ì½”ë“œ ìŠ¤íƒ€ì¼ ì¼ê´€ì„± ìœ ì§€ |
| 54 | REST API ê·œì¹™ì— ë§ëŠ” ì£¼ì†Œ í˜•ì‹ ì‚¬ìš© |
| 55 | Spring Boot 3.5.x ê¸°ì¤€, @MockitoBean í™œìš© í…ŒìŠ¤íŠ¸ ì‘ì„± |
| 56 | ë¡œê·¸ì¸/íšŒì›ê°€ì… ì‹œ @AuthenticationPrincipal ì ìš© |
| 57 | ë¡œê·¸ì¸/íšŒì›ê°€ì… ì‹œ CustomUserDetail ì ìš© |
| 58 | ê°€ë…ì„±ì´ ì¢‹ì€ ì½”ë“œ ì‘ì„± |

---

## ì ìš©í•œ ê·œì¹™ì— ëŒ€í•œ ì •ë¦¬

### ê·œì¹™ 1 â€” ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬(@ControllerAdvice)

**ì„¤ëª…:** ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•œ ê³³ì—ì„œ ì²˜ë¦¬í•˜ì—¬ try-catchë¥¼ ì œê±°í•˜ê³ , ì˜ˆì™¸ë¥¼ ì˜ë¯¸ ìˆëŠ” ë©”ì‹œì§€ë¡œ ë³€í™˜í•œë‹¤.

```java
@RestControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(DomainException.class)
    public ResponseEntity<ApiResponse<?>> handleDomainException(DomainException e) {
        return ResponseEntity.badRequest().body(ApiResponse.fail(e.getMessage()));
    }

    @ExceptionHandler(Exception.class)
    public ResponseEntity<ApiResponse<?>> handleException(Exception e) {
        return ResponseEntity.internalServerError().body(ApiResponse.fail("ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ ë°œìƒ"));
    }
}
```

> **íšŒê³ :** ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ê¸°ë¥¼ ìƒì„±í•¨ìœ¼ë¡œì¨ API í˜¸ì¶œ ì‹œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì¼ê´€ëœ í˜•íƒœë¡œ ë§ì¶¤ê³¼ ë™ì‹œì— ëª¨ë“  ì—ëŸ¬ê°€ `ApiResponse.fail()` í˜•íƒœë¡œ ë°˜í™˜ë˜ì–´ í˜‘ì—… íš¨ìœ¨ì´ ì¦ê°€í–ˆë‹¤.

---

### ê·œì¹™ 2 â€” ê³µí†µ API ì‘ë‹µ ê°ì²´ í•„ìš”

**ì„¤ëª…:** ëª¨ë“  API ì‘ë‹µì„ ì¼ê´€ëœ í˜•íƒœë¡œ ê´€ë¦¬í•˜ì—¬ ìœ ì§€ë³´ìˆ˜ì„±ì„ ë†’ì¸ë‹¤.

```java
@Getter
@Builder
public class ApiResponse<T> {
    private boolean success;
    private String message;
    private T data;

    public static <T> ApiResponse<T> ok(T data) {
        return ApiResponse.<T>builder()
                .success(true)
                .message("success")
                .data(data)
                .build();
    }

    public static <T> ApiResponse<T> fail(String message) {
        return ApiResponse.<T>builder()
                .success(false)
                .message(message)
                .build();
    }
}
```

> **íšŒê³ :** Auth í”„ë¡œì íŠ¸ì—ì„œ ë¡œê·¸ì¸ API ì‘ë‹µì´ ì²˜ìŒì—” ê·¸ëƒ¥ `Map<String, String>` ì´ì—ˆëŠ”ë° `ApiResponse`ë¥¼ ë„ì…í•˜ê³  ë‚˜ë‹ˆ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì´ í›¨ì”¬ ìˆ˜ì›”í•´ì¡Œë‹¤.

---

### ê·œì¹™ 3 â€” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì„œë¹„ìŠ¤ ê³„ì¸µì—ë§Œ ì‘ì„±

**ì„¤ëª…:** ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ìš”ì²­/ì‘ë‹µ DTO ë§¤í•‘ë§Œ ë‹´ë‹¹í•˜ê³ , ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì„œë¹„ìŠ¤ ê³„ì¸µì—ì„œë§Œ ì‘ì„±í•œë‹¤.

```java
// âŒ ë‚˜ìœ ì˜ˆì‹œ
@PostMapping("/books")
public ResponseEntity<ApiResponse<BookResponse>> createBook(@RequestBody BookRequest request) {
    Book book = new Book(request.getTitle(), request.getAuthor());
    bookRepository.save(book);
    return ResponseEntity.ok(ApiResponse.ok(BookResponse.fromEntity(book)));
}

// âœ… ì¢‹ì€ ì˜ˆì‹œ
@PostMapping("/books")
public ResponseEntity<ApiResponse<BookResponse>> createBook(@RequestBody BookRequest request) {
    return ResponseEntity.ok(ApiResponse.ok(bookService.createBook(request)));
}
```

---

### ê·œì¹™ 4 â€” DTO ê°ì²´ í™œìš©í•˜ì—¬ ë°ì´í„° ì „ë‹¬í•˜ê¸°

**ì„¤ëª…:** ì—”í‹°í‹°ë¥¼ ì§ì ‘ ë…¸ì¶œí•˜ì§€ ì•Šê³  DTOë¥¼ í†µí•´ ë°ì´í„° ì „ë‹¬.

```java
@Getter
@Builder
public class BookResponse {
    private String title;
    private String author;

    public static BookResponse fromEntity(Book book) {
        return BookResponse.builder()
                .title(book.getTitle())
                .author(book.getAuthor())
                .build();
    }
}
```

---

### ê·œì¹™ 5 â€” ìºì‹± ë„ì…ìœ¼ë¡œ ì„±ëŠ¥ ê°œì„ 

```java
@Service
@RequiredArgsConstructor
public class BookCacheService {

    private final RedisTemplate<String, Object> redisTemplate;

    public void cacheBook(String key, BookResponse book) {
        redisTemplate.opsForValue().set(key, book, 10, TimeUnit.MINUTES);
    }

    public BookResponse getBook(String key) {
        return (BookResponse) redisTemplate.opsForValue().get(key);
    }
}
```

> **íšŒê³ :** ì¸ê¸° ë„ì„œ ì¡°íšŒ APIê°€ ë°˜ë³µ í˜¸ì¶œë  ë•Œ Redis ìºì‹±ì„ ì ìš©í–ˆìœ¼ë©´ í•˜ëŠ” ì•„ì‰¬ì›€ì´ ë‚¨ëŠ”ë‹¤.

---

### ê·œì¹™ 6 â€” JWT í† í° ê¸°ë°˜ íšŒì›ê°€ì…/ë¡œê·¸ì¸ (RefreshTokenì€ Redis ì €ì¥)

**ì„¤ëª…:** AccessTokenì€ í´ë¼ì´ì–¸íŠ¸, RefreshTokenì€ Redisì— TTL ì ìš©.

```java
public AuthResponse login(AuthRequest request) {
    Member member = memberRepository.findByUsername(request.getUsername())
            .orElseThrow(() -> new AuthException("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íšŒì›ì´ë‹¤"));

    // ë¹„ë°€ë²ˆí˜¸ ì²´í¬
    if (!passwordEncoder.matches(request.getPassword(), member.getPassword())) {
        throw new AuthException("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ”ë‹¤");
    }

    String accessToken = jwtTokenProvider.createAccessToken(member.getId().toString());
    String refreshToken = jwtTokenProvider.createRefreshToken();

    redisTemplate.opsForValue().set("RT:" + member.getId(), refreshToken, 7, TimeUnit.DAYS);

    return new AuthResponse(accessToken, refreshToken);
}
```

> **íšŒê³ :** Redis TTLì„ í™œìš©í•˜ë‹ˆ ë§Œë£Œ ì²˜ë¦¬ì™€ í† í° íšŒì „ì´ í›¨ì”¬ ì‰¬ì›Œì¡Œë‹¤.

---

### ê·œì¹™ 7 â€” ì¸ì¦ ê´€ë ¨ ë³´ì•ˆ ìˆ˜ì¤€ ê³ ë ¤ (ì‹œíì–´ ì½”ë”©)

**ì„¤ëª…:** ë¹„ë°€ë²ˆí˜¸ëŠ” í‰ë¬¸ ì €ì¥ ê¸ˆì§€, JWT Secretì€ í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬.

```java
@Bean
public PasswordEncoder passwordEncoder() {
    return new BCryptPasswordEncoder();
}
```

---

### ê·œì¹™ 8 â€” ëŒ€ê·œëª¨ íŠ¸ë˜í”½ ëŒ€ë¹„ DB ì„¤ê³„

**ì„¤ëª…:** ì¸ë±ìŠ¤ ì„¤ê³„, íŒŒí‹°ì…”ë‹ ê³ ë ¤, ì½ê¸°/ì“°ê¸° ë¶„ë¦¬.

```sql
CREATE INDEX idx_books_title ON books(title);
```

> **íšŒê³ :** MoodBookì—ì„œ ë„ì„œ ê²€ìƒ‰ APIê°€ ëŠë ¤ì„œ titleì— ì¸ë±ìŠ¤ë¥¼ ì¶”ê°€í–ˆë”ë‹ˆ ì¿¼ë¦¬ ì†ë„ê°€ 10ë°° ì •ë„ ë¹¨ë¼ì¡Œë‹¤.

---

### ê·œì¹™ 10 â€” LocalDateTime ëŒ€ì‹  Instant ì‚¬ìš©

**ì„¤ëª…:** íƒ€ì„ì¡´ ì´ìŠˆ ì—†ì´ ì „ ì„¸ê³„ ì–´ë””ì„œë“  ë™ì¼í•œ ì‹œê°„ ê¸°ë¡ ê°€ëŠ¥.

```java
@Entity
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public class BaseTime {

    @CreatedDate
    private Instant createdAt;

    @LastModifiedDate
    private Instant updatedAt;
}
```

---

### ê·œì¹™ 11 â€” record ì“°ì§€ ì•Šê³  DTO ì‘ì„±

**ì„¤ëª…:** recordê°€ í¸í•˜ê¸´ í•˜ì§€ë§Œ, í™•ì¥ì„±ê³¼ `@Builder`, `@Valid` ì ìš©ì„ ê³ ë ¤í•˜ë©´ DTOëŠ” classë¡œ ì‘ì„±í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

```java
@Getter
@NoArgsConstructor
public class BookRequest {

    @NotBlank(message = "ì œëª©ì€ í•„ìˆ˜ ê°’ì´ë‹¤")
    private String title;

    @NotBlank(message = "ì €ìëŠ” í•„ìˆ˜ ê°’ì´ë‹¤")
    private String author;

    @Builder
    public BookRequest(String title, String author) {
        this.title = title;
        this.author = author;
    }
}
```

> **íšŒê³ :** record DTOë¥¼ ì¼ë‹¤ê°€, Lombok `@Builder` ì™€ Validationì„ ì ìš©í•  ìˆ˜ ì—†ì–´ì„œ classë¡œ êµì²´í–ˆë‹¤. class ê¸°ë°˜ DTOê°€ í™•ì¥ì„± ë©´ì— ìˆì–´ í™•ì‹¤íˆ ìœ ì—°í•˜ë‹¤.

---

### ê·œì¹™ 12 â€” @Setter ì–´ë…¸í…Œì´ì…˜ ì§€ì–‘

**ì„¤ëª…:** ë¶ˆë³€ì„±ì„ ì§€ì¼œ ì—”í‹°í‹°/DTOê°€ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•˜ê²Œ ë³€ê²½ë˜ì§€ ì•Šë„ë¡ í•˜ì˜€ë‹¤.

```java
@Getter
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class MemberResponse {
    private String username;
    private String nickName;
}
```

> **íšŒê³ :** MoodBook ì´ˆê¸°ì—ëŠ” `@Setter`ë¥¼ ë‚¨ë°œí•˜ë‹¤ê°€, ì–´ë””ì„œ ê°’ì´ ë³€ê²½ë˜ëŠ”ì§€ ì¶”ì ì´ ì•ˆ ëë‹¤. `@Builder`ì™€ ìƒì„±ìë§Œìœ¼ë¡œ ê°’ ì£¼ì…ì„ í†µì œí•˜ë©´ì„œ ì•ˆì •ì„±ì´ ì˜¬ë¼ê°”ë‹¤.

---

### ê·œì¹™ 14 â€” JUnit 5 + Mockito ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±

**ì„¤ëª…:** ì„œë¹„ìŠ¤ ë‹¨ìœ„ì˜ ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸ë¡œ ì•ˆì •ì„±ì„ í™•ë³´í•œë‹¤.

```java
@ExtendWith(MockitoExtension.class)
class ChatMessageServiceTest {

    @Mock
    ChatMessageRepository chatMessageRepository;

    @Mock
    MemberRepository memberRepository;

    @Mock
    RedisPublisher redisPublisher;

    @Mock
    ObjectMapper objectMapper;

    @Mock
    ChatRoomService chatRoomService;

    @InjectMocks
    ChatMessageService chatMessageService;

    @Test
    @DisplayName("TALK: ì €ì¥ í›„ Redisë¡œ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•˜ê³  DTO ë°˜í™˜")
    void process_TALK_publishAndReturn() throws Exception {
        // given
        ChatMessageSendRequestDto dto = talkReq("room-1", "u-1", "hello");

        Member sender = mock(Member.class);
        given(sender.getNickName()).willReturn("Neo");
        given(memberRepository.findById("u-1")).willReturn(Optional.of(sender));

        // save í˜¸ì¶œ ì‹œ ì €ì¥ëœ ì—”í‹°í‹° ê·¸ëŒ€ë¡œ ë°˜í™˜
        given(chatMessageRepository.save(any(ChatMessage.class)))
            .willAnswer(inv -> inv.getArgument(0));

        given(objectMapper.writeValueAsString(any(ChatMessageDto.class)))
            .willReturn("{json}");

        // when
        ChatMessageDto result = chatMessageService.processMessage(dto);

        // then
        assertThat(result).isNotNull();
        assertThat(result.getSenderNickname()).isEqualTo("Neo");
        then(redisPublisher).should().publish(eq("room-1"), eq("{json}"));
        then(chatRoomService).should(never()).joinRoom(anyString(), anyString());
        then(chatRoomService).should(never()).leaveRoom(anyString(), anyString());
    }
}
```

---

### ê·œì¹™ 15 â€” Kotlin ì½”ë“œëŠ” ì ˆëŒ€ ë‚˜íƒ€ë‚˜ì§€ ì•Šë„ë¡

**ì„¤ëª…:** íŒ€ ë‚´ ê¸°ìˆ  ìŠ¤íƒ ì¼ê´€ì„±ì„ ìœ„í•´ Kotlin ê¸ˆì§€.

```java
// âœ… Java ê¸°ë°˜ DTO
@Getter
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class ChatRequest {
    private String roomId;
    private String message;
}
```

> **íšŒê³ :** íŒ€ì› ì¤‘ í•œ ëª…ì´ Kotlin ì½”ë“œë¡œ DTOë¥¼ ì‘ì„±í–ˆëŠ”ë°, ë¹Œë“œ íŒŒì´í”„ë¼ì¸ê³¼ ìŠ¤íƒ€ì¼ì´ ê¼¬ì—¬ë²„ë ¸ë‹¤. ê·œì¹™ìœ¼ë¡œ ëª» ë°•ì•„ë‘ë‹ˆ ìœ ì§€ë³´ìˆ˜ê°€ í›¨ì”¬ ì‰¬ì›Œì¡Œë‹¤.

---

### ê·œì¹™ 18 â€” entity(DAO)ëŠ” ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê¸°

**ì„¤ëª…:** ìš”ì²­/ì‘ë‹µì€ DTOë¡œë§Œ ì²˜ë¦¬í•˜ê³ , ì—”í‹°í‹°ëŠ” ì„œë¹„ìŠ¤/ë¦¬í¬ì§€í† ë¦¬ ë‚´ë¶€ì—ì„œë§Œ ë‹¤ë£¬ë‹¤.

```java
// âŒ ë‚˜ìœ ì˜ˆì‹œ
public void createBook(Book book) { bookRepository.save(book); }

// âœ… ì¢‹ì€ ì˜ˆì‹œ
public void createBook(BookRequest request) {
    Book book = Book.builder()
            .title(request.getTitle())
            .author(request.getAuthor())
            .build();
    bookRepository.save(book);
}
```

> **íšŒê³ :** Auth í”„ë¡œì íŠ¸ ì´ˆë°˜ì— ì—”í‹°í‹°ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•˜ë‹¤ê°€, Lazy ë¡œë”© ë¬¸ì œì™€ ì§ë ¬í™” ë¬¸ì œë¥¼ ê²ªê³  ë‚˜ì„œ DTO ê¸°ë°˜ìœ¼ë¡œ ì „í™˜í–ˆë‹¤.

---

### ê·œì¹™ 19 â€” JPA N+1 ë¬¸ì œ ë°©ì§€

**ì„¤ëª…:** fetch join, EntityGraph, DTO Projection, QueryDSL í™œìš©.

```java
// Bookê³¼ Authorë¥¼ fetch join
@Query("SELECT b FROM Book b JOIN FETCH b.author WHERE b.id = :id")
Optional<Book> findBookWithAuthor(@Param("id") Long id);

// Projection DTO í™œìš©
@Query("""
        SELECT new org.com.moodbook.book.dto.BookResponse(
            b.id, b.isbn13, b.title, b.author, b.publisher, b.pubDate,
            b.reputation, b.coverImage, b.description, b.categoryName,
            b.createdAt, coalesce(bc.viewCount, 0)
        )
        FROM Book b
        LEFT JOIN BookCount bc ON b.id = bc.book.id
        ORDER BY b.pubDate DESC
    """)
Page<BookResponse> findAllByCreatedAt(Pageable pageable);

/* N + 1 ë¬¸ì œ ì²˜ë¦¬ */
@EntityGraph(attributePaths = "bookCount")
List<Book> findByIsbn13In(Collection<String> isbn13);

/* N + 1 ë¬¸ì œ ì²˜ë¦¬ */
@Query("SELECT b FROM Book b LEFT JOIN FETCH b.bookCount")
List<Book> findAllBooks();
```

---

### ê·œì¹™ 20 â€” ì„±ëŠ¥ ìµœì í™”ë¥¼ ê³ ë ¤í•œ ì½”ë“œ ì‘ì„±

**ì„¤ëª…:** ì¿¼ë¦¬ ìµœì í™”, ìºì‹œ, ì ì ˆí•œ ìë£Œêµ¬ì¡° ì‚¬ìš©.

```java
// HashMap í™œìš©í•˜ì—¬ ì‚¬ìš©ìë³„ ë„ì„œ ì¶”ì²œ ìºì‹±
private final Map<String, List<Book>> userRecommendCache = new HashMap<>();

public List<Book> getUserRecommendations(String userId) {
    return userRecommendCache.computeIfAbsent(userId, id -> loadRecommendations(id));
}
```

---

### ê·œì¹™ 21 â€” ë„ë©”ì¸ë³„ ì„œë¹„ìŠ¤ ë¶„ë¦¬ (í•œ í´ë˜ìŠ¤ì— ëª°ì•„ë„£ì§€ ì•Šê¸°)

**ì„¤ëª…:** ì—¬ëŸ¬ ë„ë©”ì¸ì˜ ë¡œì§ì„ í•œ ì„œë¹„ìŠ¤ì— ëª°ì•„ë„£ì§€ ì•Šê³ , ê° ë„ë©”ì¸ë§ˆë‹¤ ì„œë¹„ìŠ¤ë¥¼ ë¶„ë¦¬í•œë‹¤.

```java
// âŒ ë‚˜ìœ ì˜ˆì‹œ
@Service
public class CommonService {
    public void createBook(BookRequest request) { /* ... */ }
    public void login(AuthRequest request) { /* ... */ }
    public void sendChat(ChatRequest request) { /* ... */ }
}

// âœ… ì¢‹ì€ ì˜ˆì‹œ
@Service
public class BookService { /* ë„ì„œ ê´€ë ¨ ë¡œì§ */ }

@Service
public class AuthService { /* ì¸ì¦ ê´€ë ¨ ë¡œì§ */ }

@Service
public class ChatService { /* ì±„íŒ… ê´€ë ¨ ë¡œì§ */ }
```

---

### ê·œì¹™ 22 â€” ê¸°ë³¸ LAZY, ì¡°íšŒ ì „ìš©ì€ fetch join/EntityGraph/DTO í™œìš©

**ì„¤ëª…:** ì—°ê´€ ê´€ê³„ëŠ” ê¸°ë³¸ LAZYë¡œ ë‘ê³ , ì¡°íšŒ ì „ìš© ì‹œ fetch joinì„ í™œìš©í•œë‹¤.

```java
@Entity
public class Book {
    @ManyToOne(fetch = FetchType.LAZY)
    private Author author;
}

@Query("SELECT b FROM Book b JOIN FETCH b.author WHERE b.id = :id")
Optional<Book> findBookWithAuthor(@Param("id") Long id);
```

---

### ê·œì¹™ 23 â€” ì—”í‹°í‹°ë¥¼ ì‘ë‹µìœ¼ë¡œ ì§ë ¬í™” ê¸ˆì§€(â†’ DTO ë³€í™˜)

**ì„¤ëª…:** DTO ë³€í™˜ì„ ê±°ì¹œ ë’¤ JSON ì§ë ¬í™”ë¥¼ ìˆ˜í–‰í•œë‹¤.

```java
@Getter
@Builder
public class BookResponse {
    private String title;
    private String author;

    public static BookResponse fromEntity(Book book) {
        return BookResponse.builder()
                .title(book.getTitle())
                .author(book.getAuthor().getName())
                .build();
    }
}
```

---

### ê·œì¹™ 24 â€” Service ë©”ì„œë“œ ë‹¨ìœ„ @Transactional(readOnly ì ìš©)

**ì„¤ëª…:** ê° ì„œë¹„ìŠ¤ ë©”ì„œë“œì— ëª…í™•íˆ íŠ¸ëœì­ì…˜ì„ ì§€ì •í•˜ê³ , ì¡°íšŒ ì „ìš©ì—ëŠ” `readOnly=true` ë¥¼ ì ìš©í•œë‹¤.

```java
@Service
@RequiredArgsConstructor
public class BookService {

    private final BookRepository bookRepository;

    @Transactional(readOnly = true)
    public BookResponse getBook(Long id) {
        Book book = bookRepository.findById(id)
                .orElseThrow(() -> new NotFoundException("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì±…"));
        return BookResponse.fromEntity(book);
    }
}
```

---

### ê·œì¹™ 26 â€” ìš”ì²­/ì‘ë‹µ/ë„ë©”ì¸ DTO ë¶„ë¦¬, ìš”ì²­ DTOëŠ” @Valid

**ì„¤ëª…:** ìš”ì²­/ì‘ë‹µ/ë„ë©”ì¸ DTOë¥¼ ëª…í™•í•˜ê²Œ ë‚˜ëˆ„ê³ , ìš”ì²­ DTOì—ëŠ” ê²€ì¦ ì–´ë…¸í…Œì´ì…˜ì„ ì ìš©í•œë‹¤.

```java
@Getter
@NoArgsConstructor
public class AuthRequest {
    @NotBlank(message = "ì•„ì´ë””ëŠ” í•„ìˆ˜ ê°’ì´ë‹¤")
    private String username;

    @NotBlank(message = "ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ ê°’ì´ë‹¤")
    private String password;
}
```

---

### ê·œì¹™ 30 â€” ë¬´ìƒíƒœ ì„œë²„, í™•ì¥ ê³ ë ¤

**ì„¤ëª…:** ì„¸ì…˜ ëŒ€ì‹  JWT + Redis, íŒŒì¼ì€ S3 ë“± ì™¸ë¶€ ì €ì¥ì†Œ í™œìš©.

```java
// ë¬´ìƒíƒœ ì¸ì¦ (Spring Security Filter)
public class JwtTokenFilter extends OncePerRequestFilter {
    @Override
    protected void doFilterInternal(HttpServletRequest request,
                                    HttpServletResponse response,
                                    FilterChain filterChain)
            throws ServletException, IOException {

        String token = resolveToken(request);
        if (token != null && jwtTokenProvider.validateToken(token)) {
            Authentication auth = jwtTokenProvider.getAuthentication(token);
            SecurityContextHolder.getContext().setAuthentication(auth);
        }
        filterChain.doFilter(request, response);
    }
}
```

> **íšŒê³ :** DungeonTalkì—ì„œ ì„¸ì…˜ ê¸°ë°˜ ë¡œê·¸ì¸ìœ¼ë¡œ ì‹œì‘í–ˆëŠ”ë°, ë©€í‹° ì„œë²„ í™˜ê²½ì—ì„œ ì„¸ì…˜ ë™ê¸°í™” ì´ìŠˆê°€ ìƒê²¼ë‹¤. JWT + Redis êµ¬ì¡°ë¡œ ë°”ê¾¼ ë’¤ í™•ì¥ì„±ì´ í™•ë³´ëë‹¤.

---

### ê·œì¹™ 32 â€” AccessëŠ” í´ë¼ì´ì–¸íŠ¸, RefreshëŠ” ì„œë²„ ì €ì¥(DB/Redis) + íšŒì „

**ì„¤ëª…:** í´ë¼ì´ì–¸íŠ¸ëŠ” AccessTokenë§Œ ë³´ê´€í•˜ê³ , RefreshTokenì€ ì„œë²„ì—ì„œ Redis/DBì— ì €ì¥í•´ ë³´ì•ˆì„±ì„ ê°•í™”í•œë‹¤.

```java
redisTemplate.opsForValue()
    .set("RT:" + member.getId(), refreshToken, 7, TimeUnit.DAYS);
```

> **íšŒê³ :** Auth í”„ë¡œì íŠ¸ ì´ˆë°˜ì— RefreshTokenì„ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í–ˆë”ë‹ˆ íƒˆì·¨ ìœ„í—˜ì´ í™•ì¸ë˜ì–´ Redisì— RefreshTokenì„ ì €ì¥í•˜ê³  í† í° íšŒì „ì„ ì ìš©í•˜ë‹ˆ ë³´ì•ˆì„±ì´ í›¨ì”¬ ê°•í™”ëë‹¤.

---

### ê·œì¹™ 33 â€” í™˜ê²½ ë³€ìˆ˜/Secret Manager ì‚¬ìš©, @ConfigurationProperties ì£¼ì…

**ì„¤ëª…:** ë¹„ë°€ë²ˆí˜¸, ì‹œí¬ë¦¿ í‚¤ëŠ” `.yml` ì— ì§ì ‘ ì“°ì§€ ì•Šê³  í™˜ê²½ ë³€ìˆ˜ë‚˜ Secret Managerë¡œ ê´€ë¦¬í•œë‹¤.

```java
@ConfigurationProperties(prefix = "jwt")
@Getter
@Setter
public class JwtProperties {
    private String secret;
    private long accessTokenValidity;
    private long refreshTokenValidity;
}
```

```yaml
jwt:
  secret: ${JWT_SECRET}
  access-token-validity: 3600
  refresh-token-validity: 604800
```

---

### ê·œì¹™ 42 â€” Request/Response DTO ì½”ë”© ìŠ¤íƒ€ì¼ ì¼ê´€ ìœ ì§€

**ì„¤ëª…:** DTO ë³€í™˜ ë©”ì„œë“œëª…ì„ `fromEntity`, `toEntity` ì²˜ëŸ¼ í†µì¼í•˜ê³ , ìš”ì²­/ì‘ë‹µ DTOëŠ” ëª…í™•íˆ êµ¬ë¶„í•œë‹¤.

```java
@Getter
@NoArgsConstructor
public class BookRequest {
    private String title;
    private String author;

    public Book toEntity() {
        return Book.builder()
                .title(title)
                .author(author)
                .build();
    }
}

@Getter
@Builder
public class BookResponse {
    private String title;
    private String author;

    public static BookResponse fromEntity(Book book) {
        return BookResponse.builder()
                .title(book.getTitle())
                .author(book.getAuthor())
                .build();
    }
}
```

> **íšŒê³ :** í”„ë¡œì íŠ¸ ì´ˆë°˜ì—” `convert` ê°™ì€ ì œê°ê°ì˜ ë©”ì„œë“œëª…ì„ ì“°ë‹¤ë³´ë‹ˆ ê°€ë…ì„±ì´ ë–¨ì–´ì¡Œë‹¤. `fromEntity`, `toEntity`ë¡œ í†µì¼í•˜ë‹ˆ íŒ€ì› ê°„ ì½”ë“œ ì´í•´ê°€ ì‰¬ì›Œì¡Œë‹¤.

---

### ê·œì¹™ 43 â€” DTOì—ë„ @Builder ì ìš©, entity â†’ dto ë³€í™˜ ì ê·¹ í™œìš©

**ì„¤ëª…:** DTO ë³€í™˜ ì‹œ @Builderë¥¼ í™œìš©í•´ ê°€ë…ì„±ê³¼ í™•ì¥ì„±ì„ ë†’ì¸ë‹¤.

```java
@Getter
@Builder
public class MemberResponse {
    private String username;
    private String nickName;

    public static MemberResponse fromEntity(Member member) {
        return MemberResponse.builder()
                .username(member.getUsername())
                .nickName(member.getNickName())
                .build();
    }
}
```

---

### ê·œì¹™ 44 â€” Service ê³„ì¸µì€ ì¸í„°í˜ì´ìŠ¤ë¡œ ë§Œë“¤ì§€ ì•ŠìŒ

**ì„¤ëª…:** ë¶ˆí•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ ê³„ì¸µì„ ë§Œë“¤ì§€ ì•Šê³ , ë°”ë¡œ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤.

```java
// âŒ ë¶ˆí•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤
public interface BookService {
    BookResponse getBook(Long id);
}
@Service
public class BookServiceImpl implements BookService { ... }

// âœ… ë‹¨ì¼ í´ë˜ìŠ¤
@Service
@RequiredArgsConstructor
public class BookService {
    public BookResponse getBook(Long id) { /* ... */ }
}
```

---

### ê·œì¹™ 47 â€” entity ì‘ì„± ì‹œ AccessLevel.PRIVATE/PROTECTED í™œìš©

**ì„¤ëª…:** ì—”í‹°í‹° ê¸°ë³¸ ìƒì„±ìëŠ” `protected` ë‚˜ `private` ìœ¼ë¡œ ë§‰ê³ , ë¹Œë”ë‚˜ íŒ©í† ë¦¬ ë©”ì„œë“œë¡œë§Œ ìƒì„±í•œë‹¤.

```java
@Entity
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public class Member {
    @Id 
    @GeneratedValue
    private Long id;

    private String username;
    private String password;

    @Builder
    private Member(String username, String password) {
        this.username = username;
        this.password = password;
    }
}
```

---

### ê·œì¹™ 48 â€” JPA dirty-checking í™œìš©

**ì„¤ëª…:** setter ëŒ€ì‹  ì—”í‹°í‹° ê°’ ë³€ê²½ ì‹œ JPA ë”í‹°ì²´í‚¹ìœ¼ë¡œ update ì²˜ë¦¬.

```java
@Transactional
public void updateNickName(Long memberId, String newNickName) {
    Member member = memberRepository.findById(memberId)
            .orElseThrow(() -> new NotFoundException("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íšŒì›"));
    member.changeNickName(newNickName); // ì—”í‹°í‹° ë‚´ë¶€ ë©”ì„œë“œ
}
```

> **íšŒê³ :** `save()` í˜¸ì¶œì´ í•„ìš” ì—†ê³  ì½”ë“œê°€ ê°„ê²°í•´ì¡Œë‹¤.

---

### ê·œì¹™ 50 â€” BaseTime ì ìš©

**ì„¤ëª…:** ì—”í‹°í‹° ê³µí†µ ì‹œê°„ í•„ë“œë¥¼ `@MappedSuperclass` ë¡œ ê´€ë¦¬.

```java
@Getter
@MappedSuperclass
@EntityListeners(AuditingEntityListener.class)
public abstract class BaseTime {
    @CreatedDate
    private Instant createdAt;

    @LastModifiedDate
    private Instant updatedAt;
}
```

---

### ê·œì¹™ 51 â€” BaseTimeì´ë‚˜ ì—”í‹°í‹°ì— protected ì§€ì–‘

**ì„¤ëª…:** ìƒì„±ì ì ‘ê·¼ ì œì–´ ì‹œ ë¶ˆí•„ìš”í•˜ê²Œ `protected`ë¥¼ ë‚¨ë°œí•˜ì§€ ì•ŠëŠ”ë‹¤.

```java
@NoArgsConstructor(access = AccessLevel.PROTECTED) // âœ… í•„ìš”í•œ ê²½ìš°ë§Œ
public class Book { /* ... */ }
```

---

### ê·œì¹™ 56 â€” @AuthenticationPrincipal í™œìš©

**ì„¤ëª…:** ë¡œê·¸ì¸ ì‚¬ìš©ì ì •ë³´ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ í¸ë¦¬í•˜ê²Œ ì£¼ì…ë°›ëŠ”ë‹¤.

```java
@GetMapping("/me")
public ApiResponse<MemberResponse> getCurrentUser(@AuthenticationPrincipal CustomUserDetail userDetail) {
    return ApiResponse.ok(MemberResponse.fromEntity(userDetail.getMember()));
}
```

> **íšŒê³ :** Auth í”„ë¡œì íŠ¸ì—ì„œ ë§¤ë²ˆ `SecurityContextHolder`ì—ì„œ êº¼ë‚´ ì“°ë˜ ì½”ë“œë¥¼ ì—†ì• ê³ , `@AuthenticationPrincipal`ì„ ì“°ë‹ˆ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ê°„ê²°í•´ì¡Œë‹¤.

---

### ê·œì¹™ 57 â€” CustomUserDetail ì ìš©

**ì„¤ëª…:** `UserDetails`ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ì—¬ ì—”í‹°í‹°ì™€ ì—°ë™.

```java
@Getter
public class CustomUserDetail implements UserDetails {
    private final Member member;

    public CustomUserDetail(Member member) {
        this.member = member;
    }

    @Override
    public Collection<? extends GrantedAuthority> getAuthorities() {
        return List.of(new SimpleGrantedAuthority("ROLE_USER"));
    }

    @Override
    public String getPassword() { 
        return member.getPassword(); 
    }

    @Override
    public String getUsername() { 
        return member.getUsername(); 
    }
}
```
